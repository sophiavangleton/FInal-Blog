---
title: "Second Visualization"
description: |
  tbd 
author:
  - name: Sophia Angleton
output:
  distill::distill_article:
    self_contained: false
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```
 

```{r}
#| echo: False
xaringanExtra::use_panelset()
```

```{r}
#| include: False
library(here)
library(tidyverse)
library(ez)
library(psych)
library(sparkline)
library(readr)
library(ggsignif)
library(car)
library(broom)

PrepSwitch <- read.csv("~/EDLD_652/FInal Blog/_posts/2025-02-19-first-post/PrepSwitch.csv")
theme_set(theme_minimal())
head(PrepSwitch)

#clean data 

#removing practice trials from our df
prep <- PrepSwitch %>% 
  filter(practice != 1)

sum_er <- prep %>% #determine 80% accuracy 
  group_by(id) %>% 
summarize(avg_er = mean(error)) %>% 
  print()

sum_er <- sum_er %>% 
  mutate(outlier_er =  (avg_er > 0.20)) %>% 
  print() #2 people fall below 80% accuracy. id 19 and 30. 

#removing those outliers here and adding switch trials and lag trials and incongruencies. 

prep <- prep %>% 
  filter(id != 19, id != 30) %>% 
  mutate(switch = ifelse(task == lag(task,1), "No-switch", "Switch"), 
         lcsi = lag(csi, 1), incongruent = ifelse(numpresent %in% c(1,3,6,8), 0, 1), lincongruent = lag(incongruent,1), lerror = lag(error, 1), lrt = lag(rt, 1)) %>%#lag looks at trial before, need to filter out the first of each block bc nothing to compare
  filter(trial != 1, rt > 200 & rt < 4000)

prep <- prep %>% 
  group_by(id) %>% 
  mutate(alltrials = n()) %>% 
  ungroup() #I noticed there was one subject that only had 229 trials total...

#view(prep)


#aggragation of the parts of our data that we are interesting in seeing

agglag <- prep %>% 
  group_by(id, lcsi, switch) %>% #agg lag groups to then do anova. 
  summarize(rt = mean(rt[error == 0], na.rm = T), 
            error = mean(error, na.rm = T)) 
agglag

agglag2 <- agglag %>% #this is the important thing we want to see in the n-1 trials. looking at pattern of means here 
  group_by(lcsi, switch) %>% 
  summarize(rt = mean(rt, na.rm = T), 
            error = mean(error, na.rm = T)) 
agglag2


#doing our anovas for the agglag aggragates: 

anovart <- ezANOVA(data = agglag ,  
dv = rt, wid = id, within = .(lcsi, switch), type = 3, detailed = T)
anovart

anovaer <- ezANOVA(data = agglag, 
dv = error, wid = id, within = .(lcsi, switch), type = 3, detailed = T)
anovaer
```


::::: {.panelset}

::: {.panel}

## First Visualization {.pannel-name}

```{r}

```
:::

::: {.panel}

## Final Visualization {.pannel-name} 

```{r}

```

:::

::: {.panel}

## Interpretation {.panel-name}



:::

:::::
